<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<!-- Bootstrap Core CSS -->
<link href="./css/bootstrap.css" rel='stylesheet' type='text/css' th:href="@{/css/bootstrap.css}"/>

<!-- Custom CSS -->
<link href="./css/style.css" rel='stylesheet' type='text/css' th:href="@{/css/style.css}"/>

<!-- font-awesome icons CSS -->
<link href="./css/font-awesome.css" rel="stylesheet" th:href="@{/css/font-awesome.css}"> 
<!-- //font-awesome icons CSS-->

	<!-- js-->
<script src="./js/jquery-1.11.1.min.js" th:src="@{/js/jquery-1.11.1.min.js}"></script>
<script src="./js/modernizr.custom.js" th:src="@{/js/modernizr.custom.js}"></script>

<!--webfonts-->
<!-- <link href="http://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet"> -->
<!--//webfonts--> 

<!-- chart -->
<script src="./js/Chart.js" th:src="@{/js/modernizr.custom.js}"></script>
<!-- //chart -->

<!-- Art Template -->
<script type="text/javascript" src="../js/template-web.js"></script>
<!-- // Art Template -->

<!-- Metis Menu -->
<script src="./js/metisMenu.min.js" th:src="@{/js/metisMenu.min.js}"></script>
<script src="./js/custom.js" th:src="@{/js/custom.js}"></script>
<link href="./css/custom.css" rel="stylesheet" th:href="@{/css/custom.css}">
<!--//Metis Menu -->

<!--pie-chart --><!-- index page sales reviews visitors pie chart -->

<!-- side nav css file -->
<link href='./css/SidebarNav.min.css' media='all' rel='stylesheet' type='text/css' th:href="@{/css/SidebarNav.min.css}"/>
<!-- //side nav css file -->
<script src="./js/SidebarNav.min.js" th:src="@{/js/SidebarNav.min.js}"></script>

<script src="./js/jquery-1.11.1.min.js" th:src="@{/js/jquery-1.11.1.min.js}"></script>
<script src="./js/Chart.js" th:src="@{/js/modernizr.custom.js}"></script>
<link href="./assets/bootstrap.css" rel="stylesheet" th:href="@{/assets/bootstrap.css}">
<link  href="./assets/vendor/toastr/toastr.min.css" rel="stylesheet" th:href="@{/assets/vendor/toastr/toastr.min.css}"/>
<script src="./assets/vendor/toastr/toastr.min.js" th:src="@{/assets/vendor/toastr/toastr.min.js}"></script>
 
</head> 
<body class="cbp-spmenu-push">
<div class="sticky-header header-section " th:replace="head::head">	</div>
<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" th:replace="menu::menu">	</div>	
	
<!-- main content start-->
<div id="page-wrapper">
<ul class="breadcrumb" style="margin-left: 3%;">
	<li><a href="#">>系统管理>角色管理</a></li>
</ul>
<div id="accordion-magical-coder-auto-id-1564364871048" class="panel-group" role="tablist" aria-multiselectable="true" style="margin-top: 20px; margin-left: 25px; margin-right: 25px;">
    <div class="panel panel-default">
        <div class="panel-heading" role="tab">
            <h4 class="panel-title">
                <a role="button"   href="#collapseOne-magical-coder-auto-id-1564364870633" aria-expanded="false" class="collapsed">角色查询 Role of query</a>
            </h4>
        </div>
        <div  class="panel-collapse collapse in" role="tabpanel" aria-expanded="false" >
            <div class="panel-body" style="height: 107px;">
				<form action="">
	                <!--  <div class="row">   
						<div class="col-md-3 col-xs-3"> 状态 status </div>
					</div> -->
					<div class="row"> 
	                   <div class="col-xs-3">
<!--	                        <select class="form-control  searchVal2" name="" th:value="${role1?.isActive}">-->
<!--	                        		<option value="2">全选</option>-->
<!--									<option value="1" th:selected="${role?.isActive }==1">启用</option>-->
<!--									<option value="0" th:selected="${role?.isActive }==0">停用</option>-->
<!--							</select>-->
                           <input type="text" class="form-control" id="roleName" placeholder="请输入角色名称">
	                    </div>
	                    <div class="col-md-3 col-xs-3"><button type="button" class="btn btn-primary" style="margin-top: 0px; margin-right: 15px;" id="btn_select">查询select</button> </div>
	                </div>
                </form>
                
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading" role="tab">
            <h4 class="panel-title">
                <a class="" role="button" data-toggle="collapse"  href="#collapseTwo-magical-coder-auto-id-1564364869430" aria-expanded="true">角色列表 Role list</a>
            </h4>
            <button type="button" onclick="handleAddRoleClick()" class="btn btn-primary" style="float: right;margin-top: -10px">角色新增</button>
        </div>
        <div  class="panel-collapse collapse in" role="tabpanel" aria-expanded="true">
            <div class="panel-body" style="height: auto;" mc-ace="~">

                <div class="table-responsive">
                    <table class="table">
                        <thead>
					<tr>
						<th style="width: 10%;">编号</th>
						<th style="width: 50%;">角色名称 Role name</th>
<!--						<th style="width: 25%;">状态 Status</th>-->
						<th style="width: 15%;">操作 Operation</th>
					</tr>
				</thead>
				<tbody>
					<th:block th:if="${datas.content != null}">
						<tr th:each="role,roleStart: ${datas.content}">
							<td th:text="${roleStart.count}">560001</td>
							<td th:text="${role?.name}" value="${role?.name}">Bangalore</td>
							<td>
                                <button type="button" class="btn btn-primary btn-lg update_auth"  th:title="${role.id}"
									data-target="#magicalcoderMyModal-magical-coder-auto-id-1564365300654" style="font-size: 13px; padding: 3px 10px;">
                                    		编辑 edit
                                </button>
							</td>
						</tr>
					</th:block>
				</tbody>
                    </table>
                </div>
				<div th:include="page :: pager" th:remove="tag"></div>
            </div>
        </div>
    </div>
</div>
</div>

<!-- 新增角色模板 -->
<script id="add-role-tpl" type="text/html">
    <div class="panel-body" style="height: auto;">
        <form role="form"  class="form">
            <input type="hidden" id="roleId"/>
            <div class="row" style="padding: 3px 10px;margin-top:15px;margin-right:15px">
                <div class="col-xs-12">名称</div>
            </div>
            <div class="row" style="padding: 3px 10px;margin-right:15px">
                <div class="col-xs-12">
                    <input type="text" class="form-control" id="name"/>
                </div>
            </div>
            <div class="form-group text-righ" style="padding: 3px 10px;margin-top:65px;margin-right:15px">
                <button type="button" class="submit btn btn-primary pull-right "
                        style="font-size: 15px; padding: 3px 10px;float:right;margin-right:15px" onclick="AddRole()">新增</button>
            </div>
        </form>
    </div>
</script>
<script>
    function AddRole() {
        var name = $("#name").val();
        var data={name:name};
        $.ajax({
            type: "POST",
            dataType: "json",
            url: ctxPath+'role/add',
            contentType:'application/json;charset=utf-8',
            data:JSON.stringify(data),
            async:false,
            success: function (result) {
                if (result.status == 200) {
                    layer.msg('添加角色成功', {icon: 1});
                    window.location.href = window.location.href
                } else if (result.status == 500) {
                    layer.msg('添加角色失败', {icon: 5});
                }
            },
            error : function() {
                alert("服务器错误，请稍后再试")
            }
        });
    }
</script>

<!--<script src="../js/classie.js"></script>-->
<script type="text/javascript">
	var ctxPath  = [[@{/}]];
		$(function(){
    	  $(".update").on("click",function(){
    		 	var id= $(this).attr("title");
	  			var rolename=$(this).parent().siblings("td:eq(1)").text();
	  			var isActive=$(this).parent().siblings("td:eq(2)").text();
    		 	
	  			$(".roleform .id").val(id);
	  			$(".roleform .name").val(rolename);
	  			if(isActive=="启用"){
	  				$(".roleform .isActive").val(1); 
	  			}else{
	  				$(".roleform .isActive").val(0);
	  			}
    	  });

	    	  $("#btn_select").on("click",function(){
	    		  // var name=$(".searchVal1").val();
	    	      // var isActive=$(".searchVal2").val();
                  var roleName = $("#roleName").val();
                  if (roleName == "") {
                      window.location.href = ctxPath+"menu/roleIndex";
                  }else {
                      window.location.href = ctxPath+"role/index/" + roleName;
                      return true;
                  }
	          });

	    	  $(".update_auth").on("click",function(){
	    		  var id= $(this).attr("title");
	    	      window.location.href = ctxPath+"role/authorization?id="+id; 
	    	      return false;
	          });
          });

        function handleAddRoleClick() {
            var data = {}
            var html = template('add-role-tpl', data);
            layer.open({
                type: 1,
                area: ['640px', '320px'], //宽高
                shadeClose: false, //点击遮罩关闭
                content: html,
                cancel: function(){

                }
            });
        }

		function showmsg(data){
	    	  if(data.status>200){
			    	toastr.warning(data.msg);  
			       }
			    else{
			    	toastr.success(data.msg);
			      }
			 setTimeout(function(){
				window.location.reload();	      				 
			    },1000);
	      }
	      
      toastr.options = {  
   	        closeButton: false,  
   	        debug: false,  
   	        progressBar: false,  
   	        positionClass: "toast-bottom-center",  
   	        onclick: null,  
   	        showDuration: "300",  
   	        hideDuration: "1000",  
   	        timeOut: "2000",  
   	        extendedTimeOut: "1000",  
   	        showEasing: "swing",  
   	        hideEasing: "linear",  
   	        showMethod: "fadeIn",  
   	        hideMethod: "fadeOut"  
   	    }; 
	      
      	var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
      		showLeftPush = document.getElementById( 'showLeftPush' ),
      		body = document.body;
      		
      	showLeftPush.onclick = function() {
      		classie.toggle( this, 'active' );
      		classie.toggle( body, 'cbp-spmenu-push-toright' );
      		classie.toggle( menuLeft, 'cbp-spmenu-open' );
      		disableOther( 'showLeftPush' );
      	};
      	

      	function disableOther( button ) {
      		if( button !== 'showLeftPush' ) {
      			classie.toggle( showLeftPush, 'disabled' );
      		}
      	}
      </script>
 	  <script src="../pageJs/main.js" type="text/javascript" ></script>
        <!--scrolling js-->
        <script src="../js/jquery.nicescroll.js"></script>
        <script src="../js/scripts.js"></script>
        <script src="../js/layer.js"></script>
      <!-- side nav js -->
      <script src='../js/SidebarNav.min.js' type='text/javascript'></script>
      <script>
           $('.sidebar-menu').SidebarNav()
         </script>
      <script src="../js/SimpleChart.js"></script>
      <script src="../js/bootstrap.js"> </script>
</body>
</html>